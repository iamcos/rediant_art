---
import type { LayoutProps } from '../types';
import { getNavigationItems, getLanguageConfig } from '../utils';

export interface Props {
  lang?: string;
  currentPath?: string;
}

const { lang = 'en', currentPath = '/' } = Astro.props;

const navigationItems = getNavigationItems(lang);
const languageConfig = getLanguageConfig(lang);
const otherLanguage = lang === 'ru' ? 'en' : 'ru';
const otherLanguageConfig = getLanguageConfig(otherLanguage);
---

<nav class="rediant-navbar">
  <div class="rediant-nav-container">
    <!-- Logo -->
    <div class="rediant-nav-logo">
      <a href={languageConfig.href} class="rediant-logo-link">
        <span class="rediant-logo-text">Rediant</span> Art
      </a>
    </div>
    
    <!-- Desktop Menu -->
    <div class="rediant-nav-menu" id="rediant-nav-menu">
      {navigationItems.map((item) => (
        <a 
          href={item.href} 
          class={`rediant-nav-item ${currentPath === item.href ? 'rediant-nav-item-active' : ''}`}
        >
          {item.text}
        </a>
      ))}
      
      <!-- Language Switcher -->
      <div class="rediant-nav-language">
        <a href={otherLanguageConfig.href} class="rediant-lang-link">
          {otherLanguageConfig.code.toUpperCase()}
        </a>
      </div>
    </div>
    
    <!-- Mobile Menu Button -->
    <button class="rediant-nav-toggle" id="rediant-mobile-toggle" aria-label="Toggle mobile menu">
      <span class="rediant-hamburger-line"></span>
      <span class="rediant-hamburger-line"></span>
      <span class="rediant-hamburger-line"></span>
    </button>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const mobileToggle = document.getElementById('rediant-mobile-toggle');
    const navMenu = document.getElementById('rediant-nav-menu');
    
    if (mobileToggle && navMenu) {
      // Toggle mobile menu
      mobileToggle.addEventListener('click', function() {
        mobileToggle.classList.toggle('rediant-active');
        navMenu.classList.toggle('rediant-active');
        document.body.classList.toggle('rediant-menu-open');
      });
      
      // Close menu when clicking on a link
      document.querySelectorAll('.rediant-nav-item').forEach(link => {
        link.addEventListener('click', function() {
          mobileToggle.classList.remove('rediant-active');
          navMenu.classList.remove('rediant-active');
          document.body.classList.remove('rediant-menu-open');
        });
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', function(event) {
        if (event.target instanceof Element) {
          const target = event.target;
          if (!navMenu.contains(target) && !mobileToggle.contains(target)) {
            mobileToggle.classList.remove('rediant-active');
            navMenu.classList.remove('rediant-active');
            document.body.classList.remove('rediant-menu-open');
          }
        }
      });
      
      // Close menu on escape key
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          mobileToggle.classList.remove('rediant-active');
          navMenu.classList.remove('rediant-active');
          document.body.classList.remove('rediant-menu-open');
        }
      });
    }
  });
</script>

