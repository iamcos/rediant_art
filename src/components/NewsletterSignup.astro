---
export interface Props {
  title?: string;
  description?: string;
  buttonText?: string;
  successMessage?: string;
  backgroundImage?: string;
  lang?: string;
}

const {
  title = "Join Our Community",
  description = "Get exclusive access to new collections, behind-the-scenes content, and special offers.",
  buttonText = "Join Telegram",
  successMessage = "Thank you for joining!",
  backgroundImage,
  lang = "en",
} = Astro.props;
---

<section class="py-24 bg-white border-t border-gray-100">
  <div class="container mx-auto px-6 text-center">
    <div class="max-w-xl mx-auto space-y-8">
      <div class="space-y-4">
        <h2 class="text-3xl font-serif">{title}</h2>
        <p class="text-gray-500 font-light">{description}</p>
      </div>

      <form id="newsletter-form" class="space-y-4">
        <div class="flex flex-col sm:flex-row gap-4">
          <input
            type="email"
            name="email"
            placeholder="Enter your email"
            required
            class="flex-1 px-6 py-3 bg-gray-50 border border-gray-200 focus:outline-none focus:border-black transition-colors"
          />
          <button
            type="submit"
            id="newsletter-submit"
            class="px-8 py-3 bg-black text-white uppercase text-xs tracking-widest hover:bg-gold transition-colors duration-300"
          >
            <span class="newsletter-text">Subscribe</span>
            <span class="newsletter-loading hidden">...</span>
          </button>
        </div>
        <div id="newsletter-message" class="text-sm hidden"></div>
      </form>

      <div class="relative py-4">
        <div class="absolute inset-0 flex items-center">
          <div class="w-full border-t border-gray-100"></div>
        </div>
        <div
          class="relative flex justify-center text-xs uppercase tracking-widest text-gray-400 bg-white px-4"
        >
          or
        </div>
      </div>

      <a
        href="https://t.me/mizyre"
        target="_blank"
        rel="noopener noreferrer"
        class="inline-block px-8 py-3 border border-black text-black uppercase text-xs tracking-widest hover:bg-black hover:text-white transition-all duration-300"
      >
        Join Telegram Channel
      </a>
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("newsletter-form") as HTMLFormElement;
    const submitBtn = document.getElementById(
      "newsletter-submit",
    ) as HTMLButtonElement;
    const newsletterText = submitBtn.querySelector(
      ".newsletter-text",
    ) as HTMLElement;
    const newsletterLoading = submitBtn.querySelector(
      ".newsletter-loading",
    ) as HTMLElement;
    const messageDiv = document.getElementById(
      "newsletter-message",
    ) as HTMLElement;

    function showMessage(message: string, isError = false) {
      messageDiv.textContent = message;
      messageDiv.className = `text-sm ${isError ? "text-red-500" : "text-green-600"}`;
      messageDiv.style.display = "block";
    }

    function setLoading(loading: boolean) {
      if (loading) {
        submitBtn.disabled = true;
        newsletterText.style.display = "none";
        newsletterLoading.style.display = "inline";
      } else {
        submitBtn.disabled = false;
        newsletterText.style.display = "inline";
        newsletterLoading.style.display = "none";
      }
    }

    form.addEventListener("submit", async function (e) {
      e.preventDefault();
      setLoading(true);
      messageDiv.style.display = "none";

      // Simulate network request
      setTimeout(() => {
        showMessage("Thank you for subscribing!");
        form.reset();
        setLoading(false);
      }, 1000);
    });
  });
</script>
