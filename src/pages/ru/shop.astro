---
import Layout from '../../layouts/Layout.astro';
import HeroSection from '../../components/HeroSection.astro';
import CallToAction from '../../components/CallToAction.astro';
import ProductGrid from '../../components/ProductGrid.astro';
import { fetchProducts } from '../../utils';

// Fetch products server-side for SEO and ISR
const products = await fetchProducts();

// Generate structured data for SEO
const structuredProducts = products.map(product => ({
  "@type": "Product",
  "name": product.name,
  "description": product.description,
  "image": product.image,
  "offers": {
    "@type": "Offer",
    "price": product.price,
    "priceCurrency": product.currency,
    "availability": product.available ? "https://schema.org/InStock" : "https://schema.org/OutOfStock",
    "url": product.link
  },
  "category": product.category,
  "brand": {
    "@type": "Brand",
    "name": "Rediant Art"
  }
}));

// Breadcrumb structured data
const breadcrumbStructuredData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Главная",
      "item": "https://rediant.art/ru/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Магазин",
      "item": "https://rediant.art/ru/shop"
    }
  ]
};

// Collection structured data
const collectionStructuredData = {
  "@context": "https://schema.org",
  "@type": "Collection",
  "name": "Коллекция Украшений Rediant Art",
  "description": "Современные художественные украшения с цепочками для лица, головы, тела и серьгами, созданные с инновациями 3D-печати.",
  "url": "https://rediant.art/ru/shop",
  "mainEntity": {
    "@type": "ItemList",
    "itemListElement": structuredProducts
  },
  "brand": {
    "@type": "Brand",
    "name": "Rediant Art"
  }
};
---

<Layout 
  title="Магазин - Коллекция Украшений Rediant Art"
  description="Откройте для себя нашу эксклюзивную коллекцию художественных украшений. Цепочки для лица, головы, тела и серьги, созданные с инновациями 3D-печати. Обновлено с последними продуктами."
  lang="ru"
  heroImage="/images/photo_2025-09-10 23.58.23.jpeg"
  heroAlt="Коллекция украшений Rediant Art"
>
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbStructuredData)} />
  <script type="application/ld+json" set:html={JSON.stringify(collectionStructuredData)} />

  <!-- Hero Section -->
  <HeroSection
    title="Коллекция Магазина"
    subtitle="Эксклюзивные Художественные Украшения"
    description="Откройте для себя нашу уникальную коллекцию цепочек для лица, головы, тела и серег. Каждое изделие создано с точностью и художественным видением."
    backgroundImage="/images/photo_2025-09-10 23.58.23.jpeg"
    backgroundAlt="Коллекция украшений Rediant Art"
    lang="ru"
  />

  <!-- Products Section -->
  <section class="py-20 bg-neutral-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <h2 class="text-4xl sm:text-5xl font-bold text-neutral-900 mb-6">
          Наша Коллекция
        </h2>
        <p class="text-xl text-neutral-600 max-w-3xl mx-auto">
          Ручные украшения, сочетающие древние традиции с современными инновациями.
        </p>
      </div>
      
      <ProductGrid 
        products={products}
        columns={3}
        showEmpty={true}
        emptyMessage="Мы в настоящее время обновляем нашу коллекцию. Пожалуйста, проверьте позже!"
        emptyAction={{
          text: "Связаться с нами",
          href: "/ru/contact"
        }}
      />
    </div>
  </section>

  <!-- Call to Action -->
  <CallToAction
    title="Доступны Индивидуальные Заказы"
    description="Не видите именно то, что ищете? Мы создаем индивидуальные изделия, адаптированные под ваше видение. Свяжитесь с нами, чтобы обсудить ваши уникальные потребности в украшениях."
    primaryButton={{
      text: "Запросить Индивидуальное Изделие",
      href: "/ru/contact"
    }}
    secondaryButton={{
      text: "Узнать о Нашем Процессе",
      href: "/ru/about"
    }}
    variant="dark"
  />
</Layout>
